!function(){angular.module("AppModule",["ngRoute","ngAnimate","ngCookies","ui.bootstrap","ui-notification","homeModule","chart.js"]),angular.module("AppModule").constant("systemConfig",{apiUrl:"localhost"===location.hostname?"http://localhost:8076":location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")}),angular.module("AppModule").config(["$routeProvider",function(e){e.when("/",{templateUrl:"app/super-techno/system/login.html",controller:"LoginController"}).when("/home",{templateUrl:"app/super-techno/home/home.html"}).when("/main",{templateUrl:"app/super-techno/main/main.html",controller:"mainController"}).otherwise({redirectTo:"/"})}]),angular.module("AppModule").controller("IndexController",["$scope","$rootScope","$timeout","Factory","$cookieStore","$location",function(e,o,t,n,i,r){o.model={},o.level={},e.ui={},e.model.user={},o.model.map=[],e.globals={},e.ui.logout=function(){o.value=null,o.globals={},r.path("/")},e.ui.CliclLevel1=function(e){o.level.one=e,o.level.two=""},e.ui.CliclLevel2=function(e){o.level.two=e},e.ui.init=function(){e.globals=i.get("globals"),console.log("app.js"),console.log(e.globals)},e.ui.init()}])}(),function(){angular.module("AppModule").factory("Factory",["$http","systemConfig",function(e,o){var t={};return t.findAll=function(t,n,i){var r=o.apiUrl+t;e.get(r).success(function(e,o,t){n(e)}).error(function(e,o,t){i&&i(e)})},t.save=function(t,n,i,r){var a=o.apiUrl+t;e.post(a,n).success(function(e,o,t){i(e)}).error(function(e,o,t){r&&r(e)})},t.delete=function(t,n,i,r){var a=o.apiUrl+t+n;e.delete(a).success(function(e,o,t){i(e)}).error(function(e,o,t){r&&r(e)})},t.findOne=function(t,n,i){var r=o.apiUrl+t;e.get(r).success(function(e,o,t){n(e)}).error(function(e,o,t){i&&i(e)})},t.getCountList=function(t,n,i){var r=o.apiUrl+t;e.get(r).success(function(e,o,t){n(e)}).error(function(e,o,t){i&&i(e)})},t}])}(),function(){angular.module("AppModule").directive("customOnChange",function(){return{restrict:"A",link:function(e,o,t){var n=e.$eval(t.customOnChange);o.bind("change",n)}}})}(),function(){angular.module("AppModule").directive("scrolly",function(){return{restrict:"A",link:function(e,o,t){var n=o[0];o.bind("scroll",function(){n.scrollTop+n.offsetHeight===n.scrollHeight&&e.$apply(t.scrolly)})}}})}(),function(){angular.module("AppModule").directive("unique",function(){return function(e,o){var t,n={},i=e.length,r=[];for(t=0;t<i;t+=1)n[e[t][o]]=e[t];for(t in n)r.push(n[t]);return r}})}(),function(){angular.module("homeModule",["ui.bootstrap","chart.js"]),angular.module("homeModule").controller("homeController",["$scope","Factory","$rootScope","$location","$timeout","$filter","$uibModalStack","Notification","$uibModal",function(e,o,t,n,i,r,a,l,u){e.model={},e.init=function(){},e.init()}])}(),function(){angular.module("AppModule").controller("mainController",["$scope","$filter","$uibModalStack","$uibModal","$rootScope","$cookieStore","Factory","$location","Notification",function(e,o,t,n,i,r,a,l,u){e.model={},e.model.data={},e.model.popupData={},e.ui={},e.mainG={},e.model.urlACustomer="/api/sv/auto/customer",e.model.urlSCustomer="/api/sv/super/customer",e.model.urlAVehicle="/api/sv/auto/vehicle",e.model.urlSVehicle="/api/sv/super/vehicle",e.model.urlAJobDetail="/api/sv/auto/job-detail/",e.model.urlSJobDetail="/api/sv/super/job-detail/",e.model.urlASave="/api/sv/auto/save-job-detail",e.model.urlSSave="/api/sv/super/save-job-detail",e.ui.customerList=[],e.ui.vehicleList=[],e.ui.detailList=[],e.customerList=function(o){a.findAll(o,function(o){o&&(e.ui.customerList=o)},function(){})},e.vehicleList=function(o){a.findAll(o,function(o){o&&(e.ui.vehicleList=o)},function(){})},e.ui.customerLable=function(o){var t="";return angular.forEach(e.ui.customerList,function(e){if(e.cusNo===o)return void(t=e.cusName+" - "+e.mobNo)}),t},e.ui.vehicleLable=function(o){var t="";return angular.forEach(e.ui.vehicleList,function(n){if(n.jobNo===o)return t=n.vehNo+" - "+n.jobNo,e.model.data.customer=n.cusNo,e.model.data.model=n.vmake+" - "+n.vmodel,void e.ui.search(o)}),t},e.ui.search=function(o){var t="";if(1===e.mainG.currentUser.branch)t=e.model.urlSJobDetail;else{if(2!==e.mainG.currentUser.branch)return void u.error("cant find branch");t=e.model.urlAJobDetail}a.findAll(t+o,function(o){o&&(e.ui.detailList=o,console.log(o))},function(){})},e.ui.check=function(e){return parseInt(e)<=2},e.ui.bolt=function(e){return parseInt(e)>2},e.ui.popup=function(o){o.isAdminUpdate&&"editor"===e.mainG.currentUser.type?u.error("Admin Already Approved !"):(e.model.popupData=o,e.ui.unitPriceChange(),e.ui.discountChange(),n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"popup.html",scope:e,size:"lg"}))},e.ui.modelCancel=function(){t.dismissAll()},e.ui.save=function(){var t=!0;console.log(e.model.popupData),"admin"===e.mainG.currentUser.type&&(e.model.popupData.adminDate=o("date")(new Date,"yyyy-MM-dd HH:mm:ss"),e.model.popupData.isAdminUpdate=1,e.model.popupData.val=e.model.popupData.uprice*e.model.popupData.qty),"editor"===e.mainG.currentUser.type&&(console.log("editor "+e.model.popupData.isAdminUpdate),"1"===e.model.popupData.isAdminUpdate&&(console.log("$scope.mainG.currentUser.isAdminUpdate "+e.mainG.currentUser.isAdminUpdate),t=!1,u.error("You have no permission. This detail updated by admin !")),e.model.popupData.loginUser=e.mainG.currentUser.branch,e.model.popupData.isUserUpdate=1,e.model.popupData.userDate=o("date")(new Date,"yyyy-MM-dd HH:mm:ss")),"user"===e.mainG.currentUser.type&&(t=!1,u.error("You have no permission to save detail !"));var n="";if(console.log("$scope.mainG.currentUser.branch "+e.mainG.currentUser.branch),1===e.mainG.currentUser.branch?n=e.model.urlSSave:2===e.mainG.currentUser.branch?n=e.model.urlASave:(u.error("Cant find Branch !"),t=!1),t){var i=e.model.popupData,r=JSON.stringify(i);a.save(n,r,function(e){u.success("Detail save success !")},function(e){console.log(e),u.error(e.message)})}e.ui.modelCancel()},e.ui.unitPriceChange=function(){e.model.popupData.value=e.model.popupData.purchasePrice*e.model.popupData.qty,e.model.popupData.total=e.model.popupData.value-e.model.popupData.value*e.model.popupData.purchaseDiscount/100},e.ui.discountChange=function(){e.model.popupData.value=e.model.popupData.purchasePrice*e.model.popupData.qty,e.model.popupData.total=e.model.popupData.value-e.model.popupData.value*e.model.popupData.purchaseDiscount/100},e.ui.init=function(){e.mainG=r.get("globals"),console.log(e.mainG),1===e.mainG.currentUser.branch?(e.customerList(e.model.urlSCustomer),e.vehicleList(e.model.urlSVehicle)):2===e.mainG.currentUser.branch?(e.customerList(e.model.urlACustomer),e.vehicleList(e.model.urlAVehicle)):(u.error("Cant find branch !"),l.path("/"))},e.ui.init()}])}(),function(){"use strict";angular.module("AppModule").controller("LoginController",["$http","systemConfig","Factory","$scope","$rootScope","$location","AuthenticationService","$cookieStore","Notification",function(e,o,t,n,i,r,a,l,u){n.ui={},n.ui.branchList=[{indexNo:1,name:"Super Techno"},{indexNo:2,name:"Auto Reborn"}],n.ui.branchLable=function(e){var o="";return angular.forEach(n.ui.branchList,function(t){if(t.indexNo===parseInt(e))return void(o=t.indexNo+" - "+t.name)}),o},a.ClearCredentials(),n.login=function(){a.Login(n.username,n.password,n.branch,function(e){console.log(e),e?(a.SetCredentials(n.username,n.password,e.type,e.indexNo,n.branch),i.user=e,l.put("globals",i.globals),r.path("/home"),i.level.one="Home"):i.error("wrong Password!")})}}])}(),angular.module("AppModule").config(["$httpProvider",function(e){e.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",e.defaults.withCredentials=!0}]),angular.module("AppModule").factory("AuthenticationService",["systemConfig","$http","$cookieStore","$rootScope","$timeout",function(e,o,t,n,i){var r={};return n.model={name:null,password:null},r.Login=function(t,i,r,a){n.model.name=t,n.model.password=i,n.model.branch=r;var l=t+"#"+i+"#"+r+":"+i;l="Basic "+btoa(l),console.log("auth "+l),console.log(t,i);var u={Authorization:l,"X-Requested-With":"XMLHttpRequest"};console.log(u),console.log(u),console.log(u);var s=e.apiUrl+"/security/login";console.log(s);var c=JSON.stringify(n.model);o.post(s,c,{headers:u}).success(function(e){console.log(e),a(e)}).error(function(e){n.error="username or password is incorrect",console.log(e)})},r.SetCredentials=function(e,i,r,a,l){var u=btoa(e+"#"+i+"#"+l+":"+i);n.globals={currentUser:{username:e,authdata:u,type:r,indexNo:a,branch:l}},o.defaults.headers.common.Authorization="Basic "+u,t.put("globals",n.globals)},r.ClearCredentials=function(){n.globals={},t.remove("globals"),o.defaults.headers.common.Authorization="Basic "},r}]),function(){angular.module("AppModule").service("ConfirmPane",["$uibModal","$q",function(e,o){var t,n=function(e,o,n){function i(t,i){switch(this.modalInstance=t,this.timeout=i,this.message=o,this.title=n,e){case"primary":this.optionPaneClass="option-pane-primary",this.optionPaneIcon="glyphicon glyphicon-tag",this.title=void 0===this.title?"Confirm":this.title;break;case"info":this.optionPaneClass="option-pane-info",this.optionPaneIcon="glyphicon-bell",this.title=void 0===this.title?"Information":this.title;break;case"success":this.optionPaneClass="option-pane-success",this.optionPaneIcon="glyphicon-ok",this.title=void 0===this.title?"Success":this.title;break;case"warning":this.optionPaneClass="option-pane-warning",this.optionPaneIcon="glyphicon-warning-sign",this.title=void 0===this.title?"Warning":this.title;break;case"danger":this.optionPaneClass="option-pane-danger",this.optionPaneIcon="glyphicon-remove",this.title=void 0===this.title?"Danger":this.title;break;default:this.optionPaneClass="option-pane-default",this.optionPaneIcon="glyphicon-bell",this.title=void 0===this.title?"Note":this.title}}return i.prototype={confirm:function(){var e=this;this.timeout(function(){e.modalInstance.close(),t.resolve()},250)},discard:function(){var e=this;this.timeout(function(){e.modalInstance.close(),t.reject()},250)}},["$uibModalInstance","$timeout",i]};this.confirm=function(i,r,a){return t=o.defer(),e.open({animation:!0,backdrop:"static",ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"./app/dialog/confirm-pane.html",controller:n(i,r,a),controllerAs:"$ctrl",size:"md"}),{confirm:function(e){return t.promise.then(e,null),this},discard:function(e){return t.promise.then(null,e),this}}},this.primaryConfirm=function(e,o){return this.confirm("primary",e,o)},this.infoConfirm=function(e,o){return this.confirm("info",e,o)},this.successConfirm=function(e,o){return this.confirm("success",e,o)},this.warningConfirm=function(e,o){return this.confirm("warning",e,o)},this.dangerConfirm=function(e,o){return this.confirm("danger",e,o)},this.defaultConfirm=function(e,o){return this.confirm("default",e,o)}}])}(),function(){angular.module("AppModule").filter("fixedLength",function(){return function(e,o){return(1e4+""+e).slice(-o)}})}(),function(){angular.module("AppModule").controller("UserController",["$scope","Factory","Notification",function(e,o,t){e.model={},e.ui={},e.model.user={},e.model.userList=[],e.model.departmentList=[],e.model.employeeList=[];e.ui.reset=function(){e.model.user={}},e.ui.edit=function(o,t){e.model.userList.splice(t,1),e.model.user=o},e.ui.delete=function(n,i){o.delete("/api/wms/master/user/delete-user/",n,function(o){t.success("User Delete Successfully"),e.model.userList.splice(i,1)},function(e){t.error(e.message)})},e.ui.save=function(){if(e.validate()){var n=e.model.user,i=JSON.stringify(n);o.save("/api/wms/master/user/save-user",i,function(o){t.success(o.indexNo+" - User Save Successfully"),e.model.userList.push(o),e.ui.reset()},function(e){t.error(e.message)})}},e.ui.employeeLable=function(o){var t;return angular.forEach(e.model.employeeList,function(e){if(e.indexNo===parseInt(o))return void(t=e.name)}),t},e.ui.departmentLable=function(o){var t;return angular.forEach(e.model.departmentList,function(e){if(e.indexNo===parseInt(o))return void(t=e.name)}),t},e.validate=function(){return e.model.user.userName?e.model.user.password?e.model.user.reEnterPassword?e.model.user.type?e.model.user.department?e.model.user.employee?e.model.user.password!==e.model.user.reEnterPassword?(t.error("Password Not Match !!!"),!1):!!(e.model.user.userName&&e.model.user.password&&e.model.user.type&&e.model.user.department&&e.model.user.employee)||void 0:(t.error("Please Input User Descripton !!!"),!1):(t.error("Please Input User Department !!!"),!1):(t.error("Please Input User Type!!!"),!1):(t.error("Please Input Re-Enter Password !!!"),!1):(t.error("Please Input User Password !!!"),!1):(t.error("Please Input user Name !!!"),!1)},e.ui.init=function(){o.findAll("/api/wms/master/user/find-all-user",function(o){e.model.userList=o}),o.findAll("/api/wms/master/department/find-all-department",function(o){e.model.departmentList=o}),o.findAll("/api/wms/master/employee/find-all-employee",function(o){e.model.employeeList=o})},e.ui.init()}])}();